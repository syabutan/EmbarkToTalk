<ion-header class="ion-no-border">
  <ion-toolbar>
    <!-- <ion-row> -->
      <ion-buttons>
        <ion-button [routerLink]="['/home']">
          <ion-icon color="dark" name="arrow-back-outline"></ion-icon>
        </ion-button>
      </ion-buttons>
      <!-- <ion-title>

      </ion-title> -->
      
        <video [src]="videoUrl" type="video/mp4" width="100%" autoplay playsinline webkit-playsinline></video>

      </ion-toolbar>
      <ion-buttons>
        <ion-button slot="start" class="flex-left" (click)="onPlayBack();">
          <ion-icon color="dark" name="play-back-outline" ></ion-icon>
        </ion-button>
      </ion-buttons>
</ion-header>

<ion-content class="ion-no-border;">
 <!-- <div class = "all-center"> -->
     <div #list class = "fixed-content" [scrollTop] = "list.scrollHeight" >
  <div class="line-bc">

    <!--chat start-->

<div *ngFor="let log of conversationLog; let i=index">
  <ng-template #bubble>
    <div class="mycomment padding">
      <div class="balloon6">
        <div class="faceiconright">
          <img [src] = "userImage"/>
        </div>
      </div>
    </div>
  </ng-template>

  <div class="balloon6">
    <div class="faceicon">
      <img [src] = "cpImage"/>
    </div>
    <div class="chatting">
      <div  class="says">
        <ion-icon name="language-outline" style= "float:right; color: gray" (click) = "send('computerText')"></ion-icon>
        <ion-icon name="play-outline" style="float:right" (click) = "onListenToSentence(3)"></ion-icon>
        <p>{{log.computer}}</p>
      </div>
    </div>
  </div>

  <div class="mycomment">
    <div class="balloon6">
      <div class="faceiconright">
        <img [src] = "userImage"/>
      </div>
        <div class="mycommentmargin">
          <ion-icon name="language-outline" style= "float:left" (click) = "setUserArray(voice, i)"></ion-icon>
            <ion-icon name="play-outline" style="float:left" (click) = "playUserAudio(i)"></ion-icon>
          <p>{{log.player}}</p>
        </div>
    </div>
  </div>
</div>

    <!--my side comment start-->    
    <ng-template #bubble>
      <div *ngIf = "userArray.length === 0">
      <div class="mycomment">
        <div class="balloon6">
          <div class="faceiconright">
            <img [src] = "userImage"/>
          </div>
          </div>
        </div>
      </div>
    </ng-template>

    <div *ngIf = "computerSentence">
    <div class="balloon6">
      <div class="faceicon">
        <!-- <img src="https://cdn0.iconfinder.com/data/icons/avatar-2/500/man-2-512.png"/> -->
        <img [src] = "cpImage"/>
      </div>
      <div class="chatting">
        <div *ngIf = "!choiceComputerTrans" class="says">
          <ion-icon name="language-outline" style= "float:right; color: gray" (click) = "send('computerText')"></ion-icon>
          <ion-icon name="play-outline" style="float:right" (click) = "onListenToSentence(3)"></ion-icon>
          <p>{{computerSentence}}</p>
        </div>
        <div *ngIf = "choiceComputerTrans" class="says">
          <ion-icon name="language-outline" style= "float:right; color:gray" (click) = "send('computerText')"></ion-icon>
          <ion-icon *ngIf = "notPlaying" name="play-outline" style="float:right" (click) = "onListenToSentence(3)"></ion-icon>
          <ion-icon *ngIf = "!notPlaying" name="stop-outline" style="float:right" (click) = "onStopSentence()"></ion-icon>
          <p>{{data.computerText}}</p>
        </div>
      </div>
    </div>
  </div>

    <!-- <div *ngIf = "userArray.length > 0"> -->
      <div class="mycomment" *ngIf="showVoiceText">
        <div class="balloon6">
          <div class="faceiconright">
            <img [src] = "userImage"/>
          </div>
            <div class="mycommentmargin">
              <!-- <ion-icon name="language-outline" style= "float:left" (click) = "setUserArray(voice, i)"></ion-icon>
              <ion-icon name="play-outline" style="float:left" (click) = "playUserAudio(i)"></ion-icon> -->
              <p>...</p>
            </div>
        </div>
      </div>
      <div class="mycomment" *ngIf="!showVoiceText">
        <div class="balloon6">
          <div class="faceiconright">
            <img [src] = "userImage"/>
          </div>
          <div class="mycommentmargin" *ngIf="showVoiceText2">
            <ion-icon name="language-outline" style= "float:left" (click) = "setUserArray(voice, i)"></ion-icon>
            <ion-icon name="play-outline" style="float:left" (click) = "playUserAudio(i)"></ion-icon>
            <p>{{ voiceText }}</p>
          </div>
        </div>
      </div>



    <!-- </div> -->
  <!-- </div> -->
  <!-- </div> -->
</div>
</div>

  <hr>


  <div *ngIf="!lessonCompleted" class="fixed-content-bottom">
    <ion-card class="ion-no-padding">
      <ion-card-content *ngIf="!choiceOneTran else choiceone">
        <ion-icon name="language-outline" style="float:right" (click)="send('choiceOne')"></ion-icon>
        <ion-icon name="play-outline" style="float:right" (click)="onListenToSentence(1)"></ion-icon>
        {{choiceOne.player}}
      </ion-card-content>
    </ion-card>

    <ng-template #choiceone>
      <ion-card-content>
        <ion-icon name="language-outline" style="float:right" (click)="send('choiceOne')"></ion-icon>
        <ion-icon *ngIf name="play-outline" style="float:right" (click)="onListenToSentence(1)"></ion-icon>
        {{data.firstChoice}}
      </ion-card-content>
    </ng-template>

    <ion-card *ngIf="choiceTwo !== ''" class="ion-no-padding">
      <ion-card-content *ngIf="!choiceTwoTrans; else choicetwo">
        <ion-icon name="language-outline" style="float:right" (click)="send('choiceTwo')"></ion-icon>
        <ion-icon name="play-outline" style="float:right" (click)="onListenToSentence(2)"></ion-icon>
        {{choiceTwo.player}}
      </ion-card-content>
    </ion-card>

    <ng-template #choicetwo>
      <ion-card-content>
        <ion-icon name="language-outline" style="float:right" (click)="send('choiceTwo')"></ion-icon>
        <ion-icon *ngIf name="play-outline" style="float:right" (click)="onListenToSentence(2)"></ion-icon>
        {{data.secondChoice}}
      </ion-card-content>
    </ng-template>
  </div>


  <div *ngIf="!!lessonCompleted" class="fixed-content-bottom all-center">
      <div class="badge disable-hover ion-text-center">
        <img class="trophy" class="hot-air-ballon" src="../../assets/icon/Trophy.png" height="100px"/>
      </div>


      <ion-row class="item-text-center">
        <ion-col>
          <ion-button color="success" >
            previous
          </ion-button>    
        </ion-col>
        <ion-col>
  
        </ion-col>
        <ion-col>
          <ion-button color="success">
            next
          </ion-button>    
        </ion-col>
      </ion-row>
  </div>

  <button id="translatebtn" (click)="send('nothing')" style="margin-left: auto;"></button>

  <br><br><br>
  <br><br><br>
  <br><br><br>
  <!-- </div> -->
</ion-content>

<ion-footer class="ion-no-border">
  <ion-toolbar >
      <ion-row>
        <ion-col></ion-col>
        <ion-col >
          <ion-button color="primary" class="shadow"
            (click)="onStartVoiceRecognition();" *ngIf="voiceActiveSectionDisabled; else voicesection;">
            <ion-icon class="ion-padding" name="mic-outline" style="font-size: 35px; color:white;"></ion-icon>
          </ion-button>          
        </ion-col>
        <ion-col >
          <circle-progress
          [percent]= "score * 100"
          [radius]="20"
          [outerStrokeWidth]="5"
          [innerStrokeWidth]="4"
          [outerStrokeColor]="'#d17d00'"
          [innerStrokeColor]="'#a4adb3'"
          [animation]="true"
          [animationDuration]="300"
        ></circle-progress>          
        </ion-col>
        <!-- <ion-col></ion-col> -->
      </ion-row>
  
    
      <ng-template #voicesection>
      <ng-container *ngIf="!voiceActiveSectionError; else failure">
        <ng-container *ngIf="voiceText; else start">
          <ion-button color="primary" (click)="onStartVoiceRecognition()" class="shadow">
            <ion-icon class="ion-padding" name="mic-outline" style="font-size: 35px; color:white;"></ion-icon>
        
          </ion-button>
        </ng-container>
        <ng-template #start>
          <ng-container *ngIf="voiceActiveSectionListening; else beginning" (click) = "onCloseVoiceRecognition();">
              <ion-button color="light" (click) = "onCloseVoiceRecognition();" class="shadow">
                  <ion-icon class="ion-padding" name="stop-circle-outline" style = "font-size: 35px; color: red" #changeColor></ion-icon>
              </ion-button>
          </ng-container>
          <ng-template #beginning>
            <ion-button color = "light" (click) = "onCloseVoiceRecognition();"  class="shadow">
                <ion-icon class="ion-padding" name="stop-circle-outline" style = "font-size: 35px; color: red" #changeColor></ion-icon>
            </ion-button>
          </ng-template>
        </ng-template>
      </ng-container>
      <ng-template #failure>
        <ion-button color="primary" (click) = "onStartVoiceRecognition()" class="shadow">
          <ion-icon class="ion-padding" name="mic-outline" style = "font-size: 35px; color:white;"></ion-icon>
        </ion-button>
      </ng-template>
    </ng-template>


    
  </ion-toolbar>
</ion-footer>
